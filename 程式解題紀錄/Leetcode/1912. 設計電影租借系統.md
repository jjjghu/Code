## [1912. Design Movie Rental System（設計電影租借系統）（點我看題目）](https://leetcode.com/problems/design-movie-rental-system/description/)
## 思路
- `search`：輸入`movie`，需要找這個電影前五小的價格，因此需要一個能紀錄電影對應的所有價格的資料結構，並且沒有被借出。
- `rent`：借出`movie`。
- `drop`：
- `report`：
## 程式碼
### 
```c++
class MovieRentingSystem {
private:
    static constexpr int LIMIT = 5;
    // {shop, movie} -> price, long long 前 32 是 shop，後 32 是 movie，
    // 因為我不想自訂義 hash。
    unordered_map<long long, int> shopMovie_price;

    // 被借出的所有電影 {price, shop, movie}
    set<tuple<int,int,int>> rentedInfos;

    // 尚未借出的電影，對應的價格與商店
    unordered_map<int, set<pair<int,int>>> unrentedMovie_priceShop;
public:
    MovieRentingSystem(int n, vector<vector<int>>& entries) {
        // shop movie price
        for(auto& entry : entries) {
            int shop = entry[0], movie = entry[1], price = entry[2];
            shopMovie_price[1LL * shop << 32 | movie] = price;
            unrentedMovie_priceShop[movie].insert({price, shop});
        }
    }
    
    vector<int> search(int movie) {
        // 找到尚未借出、最便宜的前五名，特定電影 -> 需要對每個電影都排序最便宜的前五價格
        if(unrentedMovie_priceShop.find(movie) == unrentedMovie_priceShop.end()) {
            return {};
        }
        vector<int> res;
        for(auto& [_, shop] : unrentedMovie_priceShop.find(movie) -> second) {
            res.push_back(shop);
            if(res.size() == LIMIT) break;
        }
        return res;
    }

    void rent(int shop, int movie) {
        // 題目保證存在
        int price = shopMovie_price[1LL * shop << 32 | movie];
        rentedInfos.insert({price, shop, movie});
        unrentedMovie_priceShop[movie].erase({price, shop});
    }
    
    void drop(int shop, int movie) {
        // 題目保證已經借出
        int price = shopMovie_price[1LL * shop << 32 | movie];
        rentedInfos.erase({price, shop, movie});
        unrentedMovie_priceShop[movie].insert({price, shop});
    }
    
    vector<vector<int>> report() {
        // 借出的電影當中，最便宜的前五名, {shop, movie} -> 需要紀錄所有借出的電影資訊
        vector<vector<int>> res;
        for(auto& [_, shop, movie] : rentedInfos) {
            res.push_back({shop, movie});
            if(res.size() == LIMIT) break;
        }
        return res;
    }
};
```
## 複雜度分析
- 時間複雜度：``
- 空間複雜度：``